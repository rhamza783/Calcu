"use strict";function Menu(t,e,i,n){var s=this;n=n||{onUpdate:function(){}};this.list=e;this.wrapper=i;t.onclick=function(){s.toggle()};this.entries=[];this.onUpdate=n.onUpdate}Menu.prototype={entry:function(t,e){var i=new MenuEntry(this,e,t);this.entries.push(i);this.update();return i},value:function(t,e){var i=new MenuValue(this,e,t);this.entries.push(i);this.update();return i},onoff:function(t,e,i){var n=new MenuOnOff(this,e,i,t);this.entries.push(n);this.update();return n},link:function(t,e){var i=new MenuLink(this,e,t);this.entries.push(i);this.update();return i},close:function(){this.update();this.wrapper.setAttribute("class","hidden")},open:function(){this.update();this.wrapper.setAttribute("class","visible")},toggle:function(){this.update();this.wrapper.setAttribute("class",this.wrapper.getAttribute("class")=="hidden"?"visible":"hidden")},update:function(){for(var t=0;t<this.entries.length;t++){this.entries[t].update()}this.onUpdate(this)}};function MenuEntry(t,e,i){this.menu=t;this.shortcut=i.shortcut?i.shortcut.toUpperCase():false;this.label=i.label;this.icon=i.icon;this.action=e;this.active=i.active||function(){return true};var n=this;this.element=document.createElement("li");var s=this.shortcut?" ("+tr("ctrl")+" + "+this.shortcut+")":"";this.element.innerHTML='<button title="'+this.label+s+'"><span class="icon">'+this.icon+'</span><span class="description"> '+this.label+"</span></button>";this.element.children[0].onclick=function(t){n.menu.close();n.action();n.update()};this.menu.list.appendChild(this.element);this.update()}MenuEntry.prototype={update:function(){this.element.setAttribute("class",this.active()?"visible":"hidden")}};function MenuValue(t,e,i){this.menu=t;this.shortcut=i.shortcut.toUpperCase();this.label=i.label;this.icon=i.icon;this.action=e;this.active=i.active||function(){return true};this.value=i.value||function(){return""};var n=this;this.element=document.createElement("li");this.element.innerHTML='<label title="'+this.label+'"><span class="icon">'+this.icon+'</span> <input type="button" value=""></label>';this.button=this.element.children[0].children[this.element.children[0].children.length-1];this.button.onclick=function(t){n.menu.close();n.action(t);n.update(t)};this.menu.list.appendChild(this.element);this.update()}MenuValue.prototype={update:function(){this.element.setAttribute("class",this.active()?"visible":"hidden");this.button.setAttribute("value",this.value())}};function MenuOnOff(t,e,i,n){this.menu=t;this.shortcut=n.shortcut.toUpperCase();this.label=n.label;this.icon=n.icon;this.isActive=n.isActive||false;this.active=n.active||function(){return s.isActive};this.on=e;this.off=i;this.action=function(){if(s.active()){s.isActive=false;s.off()}else{s.isActive=true;s.on()}};var s=this;this.element=document.createElement("li");this.element.innerHTML='<button title="'+this.label+" ("+tr("ctrl")+" + "+this.shortcut+')"><span class="icon">'+this.icon+'</span><span class="description"> '+this.label+"</span></button>";this.element.children[0].onclick=function(t){s.menu.close();s.action();s.update()};this.menu.list.appendChild(this.element);this.update()}MenuOnOff.prototype={update:function(){this.element.setAttribute("class",this.active()?"on":"off")}};function MenuLink(t,e,i){this.menu=t;this.label=i.label;this.icon=i.icon;this.active=i.active||function(){return true};this.target=i.target||false;var n=this;this.element=document.createElement("li");this.element.innerHTML="<a "+(this.target?'target="'+this.target+'"':"")+' href="'+e+'" title="'+this.label+'"><span class="icon">'+this.icon+'</span><span class="description"> '+this.label+"</span></a>";this.menu.list.appendChild(this.element);this.update()}MenuLink.prototype={update:function(){this.element.setAttribute("class",this.active()?"visible":"hidden")}};